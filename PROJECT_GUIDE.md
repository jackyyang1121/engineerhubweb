# ğŸš€ EngineerHub å°ˆæ¡ˆå°è¦½

æ­¡è¿ä¾†åˆ° EngineerHub å·¥ç¨‹å¸«ç¤¾ç¾¤å¹³å°ï¼é€™æ˜¯ä¸€å€‹å®Œæ•´çš„ä¼æ¥­ç´šå°ˆæ¡ˆå°è¦½ï¼Œå°‡å¹«åŠ©æ‚¨å¿«é€Ÿç†è§£å°ˆæ¡ˆæ¶æ§‹ã€é–‹ç™¼æµç¨‹å’Œæœ€ä½³å¯¦è¸ã€‚

## ğŸ“‹ ç›®éŒ„

- [å°ˆæ¡ˆæ¦‚è¿°](#-å°ˆæ¡ˆæ¦‚è¿°)
- [æŠ€è¡“æ¶æ§‹](#-æŠ€è¡“æ¶æ§‹)
- [é …ç›®çµæ§‹](#-é …ç›®çµæ§‹)
- [é–‹ç™¼ç’°å¢ƒè¨­ç½®](#-é–‹ç™¼ç’°å¢ƒè¨­ç½®)
- [API æ–‡æª”](#-api-æ–‡æª”)
- [è³‡æ–™åº«è¨­è¨ˆ](#-è³‡æ–™åº«è¨­è¨ˆ)
- [å‰ç«¯æ¶æ§‹](#-å‰ç«¯æ¶æ§‹)
- [å¾Œç«¯æ¶æ§‹](#-å¾Œç«¯æ¶æ§‹)
- [éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—)
- [é–‹ç™¼è¦ç¯„](#-é–‹ç™¼è¦ç¯„)
- [æ¸¬è©¦ç­–ç•¥](#-æ¸¬è©¦ç­–ç•¥)
- [æ€§èƒ½å„ªåŒ–](#-æ€§èƒ½å„ªåŒ–)
- [å®‰å…¨è€ƒé‡](#-å®‰å…¨è€ƒé‡)
- [æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)

## ğŸ¯ å°ˆæ¡ˆæ¦‚è¿°

### å°ˆæ¡ˆç†å¿µ
EngineerHub æ˜¯å°ˆç‚ºå·¥ç¨‹å¸«æ‰“é€ çš„ç¤¾ç¾¤å¹³å°ï¼Œæä¾›ï¼š
- æŠ€è¡“è¨è«–èˆ‡åˆ†äº«
- ç¨‹å¼ç¢¼ç‰‡æ®µå±•ç¤ºï¼ˆæ”¯æ´100å¤šç¨®èªè¨€é«˜äº®ï¼‰
- å¤šåª’é«”å…§å®¹åˆ†äº«ï¼ˆåœ–ç‰‡/å½±ç‰‡ï¼‰
- å³æ™‚èŠå¤©é€šè¨Š
- å€‹äººä½œå“é›†å±•ç¤º
- ç¤¾äº¤é—œæ³¨åŠŸèƒ½

### æ ¸å¿ƒç‰¹è‰²
- ğŸ¨ **ç°¡ç´„ç¾è§€çš„UIè¨­è¨ˆ**
- ğŸ“± **å®Œå…¨éŸ¿æ‡‰å¼è¨­è¨ˆ**
- âš¡ **é«˜æ€§èƒ½èˆ‡å¿«é€Ÿè¼‰å…¥**
- ğŸ”’ **ä¼æ¥­ç´šå®‰å…¨æ€§**
- ğŸŒ **å¤šèªè¨€æ”¯æ´**
- ğŸ” **å¼·å¤§çš„æœç´¢åŠŸèƒ½**

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æ•´é«”æ¶æ§‹åœ–
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (React)   â”‚ â†â†’â”‚  å¾Œç«¯ (Django)   â”‚ â†â†’ â”‚ è³‡æ–™åº« (PostgreSQL) â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ TypeScript    â”‚    â”‚ â€¢ REST API      â”‚    â”‚ â€¢ Redis (ç·©å­˜)   â”‚
â”‚ â€¢ Tailwind CSS  â”‚    â”‚ â€¢ WebSocket     â”‚    â”‚ â€¢ Elasticsearch â”‚
â”‚ â€¢ React Query   â”‚    â”‚ â€¢ Celery        â”‚    â”‚ â€¢ æ–‡ä»¶å­˜å„²       â”‚
â”‚ â€¢ Zustand       â”‚    â”‚ â€¢ JWT èªè­‰      â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“æ£§è©³ç´°

#### å‰ç«¯æŠ€è¡“
- **æ¡†æ¶**: React 18 + TypeScript
- **æ§‹å»ºå·¥å…·**: Vite
- **æ¨£å¼**: Tailwind CSS
- **ç‹€æ…‹ç®¡ç†**: Zustand
- **æ•¸æ“šç²å–**: React Query (TanStack Query)
- **è·¯ç”±**: React Router
- **è¡¨å–®è™•ç†**: React Hook Form
- **ç¨‹å¼ç¢¼é«˜äº®**: Prism.js
- **åœ–æ¨™**: Heroicons

#### å¾Œç«¯æŠ€è¡“
- **æ¡†æ¶**: Django 4.2 + Django REST Framework
- **è³‡æ–™åº«**: PostgreSQL 15
- **ç·©å­˜**: Redis
- **æœç´¢**: Elasticsearch
- **ä»»å‹™éšŠåˆ—**: Celery
- **èªè­‰**: JWT + OAuth2 (Google, GitHub)
- **æ–‡ä»¶å­˜å„²**: AWS S3 (ç”Ÿç”¢ç’°å¢ƒ) / æœ¬åœ°å­˜å„² (é–‹ç™¼ç’°å¢ƒ)
- **ç¨‹å¼ç¢¼é«˜äº®**: Pygments
- **å³æ™‚é€šè¨Š**: Django Channels + WebSocket

#### åŸºç¤è¨­æ–½
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **åå‘ä»£ç†**: Nginx
- **WSGIæœå‹™å™¨**: Gunicorn
- **ç›£æ§**: Sentry
- **æ—¥èªŒ**: çµæ§‹åŒ–æ—¥èªŒ + ELK Stack
- **CI/CD**: GitHub Actions

## ğŸ“ é …ç›®çµæ§‹

```
engineerhubweb/
â”œâ”€â”€ backend/                    # Django å¾Œç«¯
â”‚   â”œâ”€â”€ engineerhub/           # Django å°ˆæ¡ˆè¨­ç½®
â”‚   â”‚   â”œâ”€â”€ settings/          # åˆ†ç’°å¢ƒè¨­ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py       # åŸºç¤è¨­ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ development.py # é–‹ç™¼ç’°å¢ƒ
â”‚   â”‚   â”‚   â””â”€â”€ production.py  # ç”Ÿç”¢ç’°å¢ƒ
â”‚   â”‚   â”œâ”€â”€ urls.py           # ä¸»URLé…ç½®
â”‚   â”‚   â”œâ”€â”€ wsgi.py          # WSGIå…¥å£
â”‚   â”‚   â””â”€â”€ asgi.py          # ASGIå…¥å£ï¼ˆWebSocketï¼‰
â”‚   â”œâ”€â”€ accounts/             # ç”¨æˆ¶æ¨¡å¡Š
â”‚   â”‚   â”œâ”€â”€ models.py        # ç”¨æˆ¶æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ serializers.py   # åºåˆ—åŒ–å™¨
â”‚   â”‚   â”œâ”€â”€ views.py         # APIè¦–åœ–
â”‚   â”‚   â””â”€â”€ urls.py          # URLè·¯ç”±
â”‚   â”œâ”€â”€ posts/               # è²¼æ–‡æ¨¡å¡Š
â”‚   â”œâ”€â”€ comments/            # è©•è«–æ¨¡å¡Š
â”‚   â”œâ”€â”€ chats/              # èŠå¤©æ¨¡å¡Š
â”‚   â”œâ”€â”€ notifications/       # é€šçŸ¥æ¨¡å¡Š
â”‚   â”œâ”€â”€ search/             # æœç´¢æ¨¡å¡Š
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒå·¥å…·
â”‚   â”‚   â”œâ”€â”€ pagination.py   # åˆ†é è¨­ç½®
â”‚   â”‚   â”œâ”€â”€ permissions.py  # æ¬Šé™é¡
â”‚   â”‚   â”œâ”€â”€ exceptions.py   # ç•°å¸¸è™•ç†
â”‚   â”‚   â””â”€â”€ utils.py        # å·¥å…·å‡½æ•¸
â”‚   â”œâ”€â”€ requirements.txt     # Pythonä¾è³´
â”‚   â””â”€â”€ manage.py           # Djangoç®¡ç†è…³æœ¬
â”œâ”€â”€ frontend/               # React å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # å¯å¾©ç”¨çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ common/    # é€šç”¨çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ forms/     # è¡¨å–®çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ posts/     # è²¼æ–‡çµ„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ users/     # ç”¨æˆ¶çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/         # é é¢çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ hooks/         # è‡ªå®šç¾©Hooks
â”‚   â”‚   â”œâ”€â”€ store/         # Zustandç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/           # APIèª¿ç”¨
â”‚   â”‚   â”œâ”€â”€ types/         # TypeScripté¡å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•¸
â”‚   â”‚   â””â”€â”€ styles/        # æ¨£å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ public/            # éœæ…‹è³‡æº
â”‚   â”œâ”€â”€ package.json       # Node.jsä¾è³´
â”‚   â””â”€â”€ vite.config.ts     # Viteé…ç½®
â”œâ”€â”€ docs/                  # æ–‡æª”
â”œâ”€â”€ docker/               # Dockeré…ç½®
â”œâ”€â”€ nginx/                # Nginxé…ç½®
â””â”€â”€ scripts/              # éƒ¨ç½²è…³æœ¬
```

## ğŸ› ï¸ é–‹ç™¼ç’°å¢ƒè¨­ç½®

### å…ˆæ±ºæ¢ä»¶
- Node.js 18+
- Python 3.11+
- PostgreSQL 15+
- Redis 6+
- Git

### å¿«é€Ÿé–‹å§‹

#### 1. å…‹éš†å°ˆæ¡ˆ
```bash
git clone https://github.com/your-org/engineerhubweb.git
cd engineerhubweb
```

#### 2. å¾Œç«¯è¨­ç½®
```bash
cd backend

# å‰µå»ºè™›æ“¬ç’°å¢ƒ
python -m venv venv

# æ¿€æ´»è™›æ“¬ç’°å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux  
source venv/bin/activate

# å®‰è£ä¾è³´
pip install -r requirements.txt

# è¤‡è£½ç’°å¢ƒè®Šæ•¸æ–‡ä»¶
cp .env.example .env
# ç·¨è¼¯ .env æ–‡ä»¶é…ç½®å¿…è¦åƒæ•¸

# åŸ·è¡Œé·ç§»
python manage.py migrate

# å‰µå»ºè¶…ç´šç”¨æˆ¶
python manage.py createsuperuser

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
python manage.py runserver
```

#### 3. å‰ç«¯è¨­ç½®
```bash
cd frontend

# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```

#### 4. é¡å¤–æœå‹™è¨­ç½®
```bash
# å•Ÿå‹• Redis
redis-server

# å•Ÿå‹• Celery Workerï¼ˆæ–°çµ‚ç«¯ï¼‰
cd backend
celery -A engineerhub worker -l info

# å•Ÿå‹• Celery Beatï¼ˆæ–°çµ‚ç«¯ï¼‰
cd backend
celery -A engineerhub beat -l info
```

## ğŸ“š API æ–‡æª”

### API ç«¯é»æ¦‚è¦½

#### èªè­‰ç›¸é—œ
- `POST /auth/registration/` - ç”¨æˆ¶è¨»å†Š
- `POST /auth/login/` - ç”¨æˆ¶ç™»å…¥
- `POST /auth/logout/` - ç”¨æˆ¶ç™»å‡º
- `POST /auth/token/refresh/` - åˆ·æ–°Token
- `POST /auth/google/` - Google OAuthç™»å…¥
- `POST /auth/github/` - GitHub OAuthç™»å…¥

#### ç”¨æˆ¶ç®¡ç†
- `GET /users/me/` - ç²å–ç•¶å‰ç”¨æˆ¶ä¿¡æ¯
- `PATCH /users/me/` - æ›´æ–°ç”¨æˆ¶è³‡æ–™
- `POST /users/{id}/follow/` - é—œæ³¨ç”¨æˆ¶
- `DELETE /users/{id}/follow/` - å–æ¶ˆé—œæ³¨

#### è²¼æ–‡ç³»çµ±
- `GET /posts/` - ç²å–è²¼æ–‡åˆ—è¡¨
- `POST /posts/` - å‰µå»ºè²¼æ–‡
- `GET /posts/{id}/` - ç²å–è²¼æ–‡è©³æƒ…
- `PATCH /posts/{id}/` - æ›´æ–°è²¼æ–‡
- `DELETE /posts/{id}/` - åˆªé™¤è²¼æ–‡
- `POST /posts/{id}/like/` - é»è®šè²¼æ–‡

#### è©•è«–ç³»çµ±
- `GET /posts/{id}/comments/` - ç²å–è²¼æ–‡è©•è«–
- `POST /posts/comments/` - å‰µå»ºè©•è«–
- `GET /comments/{id}/replies/` - ç²å–è©•è«–å›è¦†

### API ä½¿ç”¨ç¯„ä¾‹

#### å‰µå»ºè²¼æ–‡
```javascript
const createPost = async (postData) => {
  const formData = new FormData();
  formData.append('content', postData.content);
  
  if (postData.code_snippet) {
    formData.append('code_snippet', postData.code_snippet);
  }
  
  if (postData.media) {
    postData.media.forEach((file, index) => {
      formData.append(`media[${index}]`, file);
    });
  }
  
  const response = await fetch('/api/posts/', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${accessToken}`,
    },
    body: formData
  });
  
  return response.json();
};
```

## ğŸ—„ï¸ è³‡æ–™åº«è¨­è¨ˆ

### æ ¸å¿ƒå¯¦é«”é—œä¿‚åœ–
```
ç”¨æˆ¶ (User)
â”œâ”€â”€ è²¼æ–‡ (Post) â”€â”€â”€â”€â”
â”œâ”€â”€ è©•è«– (Comment) â”€â”¤
â”œâ”€â”€ é—œæ³¨ (Follow) â”€â”€â”¤
â”œâ”€â”€ ä½œå“é›† (Portfolio) â”€â”€â”¤
â””â”€â”€ è¨­ç½® (UserSettings) â”€â”€â”¤
                         â”‚
è²¼æ–‡ (Post)              â”‚
â”œâ”€â”€ åª’é«” (PostMedia) â”€â”€â”€â”€â”¤
â”œâ”€â”€ é»è®š (Like) â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€ æ”¶è— (Save) â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â””â”€â”€ èˆ‰å ± (Report) â”€â”€â”€â”€â”€â”€â”˜
```

### é—œéµæ¨¡å‹èªªæ˜

#### User æ¨¡å‹
```python
class User(AbstractUser):
    id = UUIDField(primary_key=True)  # ä½¿ç”¨UUIDä½œç‚ºä¸»éµ
    email = EmailField(unique=True)   # éƒµç®±ç™»å…¥
    bio = TextField(max_length=500)   # å€‹äººç°¡ä»‹
    avatar = ImageField()             # é ­åƒ
    skill_tags = JSONField()          # æŠ€èƒ½æ¨™ç±¤
    is_online = BooleanField()        # åœ¨ç·šç‹€æ…‹
    # çµ±è¨ˆæ•¸æ“šï¼ˆéè¦ç¯„åŒ–è¨­è¨ˆæå‡æ€§èƒ½ï¼‰
    followers_count = PositiveIntegerField()
    posts_count = PositiveIntegerField()
```

#### Post æ¨¡å‹
```python
class Post(models.Model):
    id = UUIDField(primary_key=True)
    author = ForeignKey(User)
    content = TextField()             # æ–‡å­—å…§å®¹
    code_snippet = TextField()       # ç¨‹å¼ç¢¼ç‰‡æ®µ
    code_language = CharField()      # ç¨‹å¼èªè¨€ï¼ˆè‡ªå‹•æª¢æ¸¬ï¼‰
    code_highlighted = TextField()   # é«˜äº®HTML
    # çµ±è¨ˆæ•¸æ“š
    likes_count = PositiveIntegerField()
    comments_count = PositiveIntegerField()
    views_count = PositiveIntegerField()
```

### ç´¢å¼•ç­–ç•¥
```sql
-- ç”¨æˆ¶ç›¸é—œç´¢å¼•
CREATE INDEX idx_user_email ON accounts_user(email);
CREATE INDEX idx_user_username ON accounts_user(username);
CREATE INDEX idx_user_online ON accounts_user(is_online);

-- è²¼æ–‡ç›¸é—œç´¢å¼•
CREATE INDEX idx_post_author_created ON posts_post(author_id, created_at DESC);
CREATE INDEX idx_post_created ON posts_post(created_at DESC);
CREATE INDEX idx_post_likes ON posts_post(likes_count DESC);

-- é—œæ³¨é—œä¿‚ç´¢å¼•
CREATE INDEX idx_follow_follower ON accounts_follow(follower_id, created_at);
CREATE INDEX idx_follow_following ON accounts_follow(following_id, created_at);
```

## ğŸ¨ å‰ç«¯æ¶æ§‹

### çµ„ä»¶æ¶æ§‹
```
App
â”œâ”€â”€ Layout
â”‚   â”œâ”€â”€ Header
â”‚   â”œâ”€â”€ Sidebar
â”‚   â””â”€â”€ Footer
â”œâ”€â”€ Pages
â”‚   â”œâ”€â”€ Home
â”‚   â”œâ”€â”€ Profile
â”‚   â”œâ”€â”€ Post
â”‚   â””â”€â”€ Settings
â””â”€â”€ Components
    â”œâ”€â”€ Common (æŒ‰éˆ•ã€è¼¸å…¥æ¡†ã€æ¨¡æ…‹æ¡†ç­‰)
    â”œâ”€â”€ Forms (è¡¨å–®çµ„ä»¶)
    â”œâ”€â”€ Posts (è²¼æ–‡ç›¸é—œçµ„ä»¶)
    â””â”€â”€ Users (ç”¨æˆ¶ç›¸é—œçµ„ä»¶)
```

### ç‹€æ…‹ç®¡ç†ç­–ç•¥

#### Zustand Store çµæ§‹
```typescript
// authStore.ts - èªè­‰ç‹€æ…‹
interface AuthState {
  user: UserData | null;
  isAuthenticated: boolean;
  login: (credentials: LoginData) => Promise<void>;
  logout: () => void;
}

// uiStore.ts - UIç‹€æ…‹
interface UIState {
  theme: 'light' | 'dark' | 'auto';
  sidebar: { isOpen: boolean };
  modal: { isOpen: boolean; content?: ReactNode };
}
```

#### React Query ä½¿ç”¨
```typescript
// è²¼æ–‡æŸ¥è©¢
const usePosts = (page = 1) => {
  return useQuery({
    queryKey: ['posts', page],
    queryFn: () => postApi.getPosts(page),
    staleTime: 5 * 60 * 1000, // 5åˆ†é˜
  });
};

// è²¼æ–‡çªè®Š
const useCreatePost = () => {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: postApi.createPost,
    onSuccess: () => {
      queryClient.invalidateQueries(['posts']);
    },
  });
};
```

### è·¯ç”±è¨­è¨ˆ
```typescript
const router = createBrowserRouter([
  {
    path: '/',
    element: <Layout />,
    children: [
      { index: true, element: <Home /> },
      { path: 'profile/:username', element: <Profile /> },
      { path: 'post/:id', element: <PostDetail /> },
      { path: 'settings', element: <Settings /> },
    ],
  },
  {
    path: '/auth',
    element: <AuthLayout />,
    children: [
      { path: 'login', element: <Login /> },
      { path: 'register', element: <Register /> },
    ],
  },
]);
```

## âš™ï¸ å¾Œç«¯æ¶æ§‹

### Django æ‡‰ç”¨çµæ§‹

#### æ ¸å¿ƒæ‡‰ç”¨
- **accounts** - ç”¨æˆ¶ç®¡ç†ã€èªè­‰ã€å€‹äººè³‡æ–™
- **posts** - è²¼æ–‡ç³»çµ±ã€åª’é«”è™•ç†ã€ç¨‹å¼ç¢¼é«˜äº®
- **comments** - è©•è«–ç³»çµ±ã€å¤šå±¤ç´šå›è¦†
- **chats** - å³æ™‚èŠå¤©ã€WebSocketè™•ç†
- **notifications** - é€šçŸ¥ç³»çµ±ã€æ¨é€æœå‹™
- **search** - æœç´¢åŠŸèƒ½ã€Elasticsearché›†æˆ
- **core** - æ ¸å¿ƒå·¥å…·ã€é€šç”¨çµ„ä»¶

### API è¨­è¨ˆåŸå‰‡

#### RESTful API è¦ç¯„
```python
# è³‡æºå‘½å
GET    /api/posts/           # ç²å–è²¼æ–‡åˆ—è¡¨
POST   /api/posts/           # å‰µå»ºè²¼æ–‡
GET    /api/posts/{id}/      # ç²å–å–®å€‹è²¼æ–‡
PATCH  /api/posts/{id}/      # éƒ¨åˆ†æ›´æ–°è²¼æ–‡
DELETE /api/posts/{id}/      # åˆªé™¤è²¼æ–‡

# åµŒå¥—è³‡æº
GET    /api/posts/{id}/comments/     # ç²å–è²¼æ–‡çš„è©•è«–
POST   /api/posts/{id}/comments/     # å°è²¼æ–‡å‰µå»ºè©•è«–
```

#### éŸ¿æ‡‰æ ¼å¼æ¨™æº–åŒ–
```python
# æˆåŠŸéŸ¿æ‡‰
{
  "success": true,
  "data": { ... },
  "message": "æ“ä½œæˆåŠŸ"
}

# éŒ¯èª¤éŸ¿æ‡‰
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "æ•¸æ“šé©—è­‰å¤±æ•—",
    "details": {
      "field_name": ["éŒ¯èª¤æè¿°"]
    }
  }
}
```

### ä¸­é–“ä»¶èˆ‡æ¬Šé™

#### è‡ªå®šç¾©ä¸­é–“ä»¶
```python
class OnlineStatusMiddleware:
    """æ›´æ–°ç”¨æˆ¶åœ¨ç·šç‹€æ…‹çš„ä¸­é–“ä»¶"""
    
    def __init__(self, get_response):
        self.get_response = get_response
    
    def __call__(self, request):
        if request.user.is_authenticated:
            request.user.update_online_status()
        
        response = self.get_response(request)
        return response
```

#### æ¬Šé™é¡
```python
class IsOwnerOrReadOnly(BasePermission):
    """åªæœ‰ä½œè€…å¯ä»¥ç·¨è¼¯ï¼Œå…¶ä»–äººåªèƒ½è®€å–"""
    
    def has_object_permission(self, request, view, obj):
        if request.method in SAFE_METHODS:
            return True
        return obj.author == request.user
```

### WebSocket è™•ç†

#### èŠå¤©æ¶ˆè²»è€…
```python
class ChatConsumer(AsyncWebsocketConsumer):
    async def connect(self):
        self.room_name = self.scope['url_route']['kwargs']['room_name']
        self.room_group_name = f'chat_{self.room_name}'
        
        await self.channel_layer.group_add(
            self.room_group_name,
            self.channel_name
        )
        await self.accept()
    
    async def receive(self, text_data):
        data = json.loads(text_data)
        message = data['message']
        
        # ä¿å­˜æ¶ˆæ¯åˆ°è³‡æ–™åº«
        await self.save_message(message)
        
        # å»£æ’­æ¶ˆæ¯
        await self.channel_layer.group_send(
            self.room_group_name,
            {
                'type': 'chat_message',
                'message': message
            }
        )
```

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²

#### docker-compose.yml
```yaml
version: '3.8'

services:
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: engineerhub
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:6-alpine

  backend:
    build: ./backend
    ports:
      - "8000:8000"
    depends_on:
      - db
      - redis
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/engineerhub
      - REDIS_URL=redis://redis:6379

  frontend:
    build: ./frontend
    ports:
      - "3000:3000"

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf

volumes:
  postgres_data:
```

### ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²

#### 1. æœå‹™å™¨æº–å‚™
```bash
# æ›´æ–°ç³»çµ±
sudo apt update && sudo apt upgrade -y

# å®‰è£ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# å®‰è£ Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

#### 2. éƒ¨ç½²è…³æœ¬
```bash
#!/bin/bash
# deploy.sh

set -e

echo "é–‹å§‹éƒ¨ç½² EngineerHub..."

# æ‹‰å–æœ€æ–°ä»£ç¢¼
git pull origin main

# æ§‹å»ºä¸¦å•Ÿå‹•æœå‹™
docker-compose -f docker-compose.prod.yml build
docker-compose -f docker-compose.prod.yml up -d

# åŸ·è¡Œè³‡æ–™åº«é·ç§»
docker-compose -f docker-compose.prod.yml exec backend python manage.py migrate

# æ”¶é›†éœæ…‹æ–‡ä»¶
docker-compose -f docker-compose.prod.yml exec backend python manage.py collectstatic --noinput

echo "éƒ¨ç½²å®Œæˆï¼"
```

#### 3. SSL è­‰æ›¸è¨­ç½®
```bash
# å®‰è£ Certbot
sudo apt install certbot python3-certbot-nginx

# ç²å–è­‰æ›¸
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com

# è¨­ç½®è‡ªå‹•çºŒæœŸ
sudo crontab -e
# æ·»åŠ ï¼š0 12 * * * /usr/bin/certbot renew --quiet
```

## ğŸ“ é–‹ç™¼è¦ç¯„

### ä»£ç¢¼é¢¨æ ¼

#### Python (å¾Œç«¯)
```python
# ä½¿ç”¨ Black æ ¼å¼åŒ–
pip install black
black .

# ä½¿ç”¨ isort æ•´ç†å°å…¥
pip install isort
isort .

# ä½¿ç”¨ flake8 æª¢æŸ¥
pip install flake8
flake8 .
```

#### TypeScript (å‰ç«¯)
```json
// .eslintrc.json
{
  "extends": [
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/explicit-function-return-type": "warn"
  }
}
```

### Git å·¥ä½œæµ

#### åˆ†æ”¯ç­–ç•¥
```
main (ä¸»åˆ†æ”¯)
â”œâ”€â”€ develop (é–‹ç™¼åˆ†æ”¯)
â”œâ”€â”€ feature/user-authentication (åŠŸèƒ½åˆ†æ”¯)
â”œâ”€â”€ feature/post-system (åŠŸèƒ½åˆ†æ”¯)
â”œâ”€â”€ hotfix/critical-bug-fix (ç·Šæ€¥ä¿®å¾©)
â””â”€â”€ release/v1.0.0 (ç™¼ç‰ˆåˆ†æ”¯)
```

#### æäº¤è¨Šæ¯è¦ç¯„
```
<type>(<scope>): <description>

[optional body]

[optional footer]

ç¯„ä¾‹ï¼š
feat(auth): add Google OAuth integration
fix(posts): resolve code highlighting issue
docs(api): update authentication endpoints
```

### ä»£ç¢¼å¯©æŸ¥æª¢æŸ¥æ¸…å–®

#### åŠŸèƒ½æª¢æŸ¥
- [ ] åŠŸèƒ½æ˜¯å¦æŒ‰éœ€æ±‚æ­£ç¢ºå¯¦ç¾
- [ ] é‚Šç•Œæƒ…æ³æ˜¯å¦è™•ç†
- [ ] éŒ¯èª¤è™•ç†æ˜¯å¦å®Œå–„
- [ ] æ€§èƒ½æ˜¯å¦å¯æ¥å—

#### ä»£ç¢¼å“è³ª
- [ ] å‘½åæ˜¯å¦æ¸…æ™°
- [ ] ä»£ç¢¼æ˜¯å¦éµå¾ª DRY åŸå‰‡
- [ ] æ˜¯å¦æœ‰é©ç•¶çš„è¨»é‡‹
- [ ] æ˜¯å¦éµå¾ªé …ç›®è¦ç¯„

#### å®‰å…¨æª¢æŸ¥
- [ ] æ˜¯å¦æœ‰SQLæ³¨å…¥é¢¨éšª
- [ ] è¼¸å…¥é©—è­‰æ˜¯å¦å……åˆ†
- [ ] æ¬Šé™æª¢æŸ¥æ˜¯å¦æ­£ç¢º
- [ ] æ•æ„Ÿæ•¸æ“šæ˜¯å¦ä¿è­·

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### å¾Œç«¯æ¸¬è©¦

#### å–®å…ƒæ¸¬è©¦
```python
# tests/test_models.py
class UserModelTest(TestCase):
    def setUp(self):
        self.user = User.objects.create_user(
            username='testuser',
            email='test@example.com',
            password='testpass123'
        )
    
    def test_user_creation(self):
        self.assertEqual(self.user.username, 'testuser')
        self.assertEqual(self.user.email, 'test@example.com')
        self.assertTrue(self.user.check_password('testpass123'))
    
    def test_avatar_url_property(self):
        expected_url = f"https://ui-avatars.com/api/?name={self.user.username}&background=random&size=400"
        self.assertEqual(self.user.avatar_url, expected_url)
```

#### API æ¸¬è©¦
```python
# tests/test_apis.py
class PostAPITest(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(
            username='testuser',
            email='test@example.com',
            password='testpass123'
        )
        self.client.force_authenticate(user=self.user)
    
    def test_create_post(self):
        data = {
            'content': 'Test post content',
            'code_snippet': 'print("Hello World")'
        }
        response = self.client.post('/api/posts/', data)
        self.assertEqual(response.status_code, 201)
        self.assertEqual(response.data['content'], 'Test post content')
```

### å‰ç«¯æ¸¬è©¦

#### çµ„ä»¶æ¸¬è©¦
```typescript
// __tests__/PostCard.test.tsx
import { render, screen } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import PostCard from '../components/posts/PostCard';

const mockPost = {
  id: '1',
  author: 'testuser',
  content: 'Test post content',
  likes_count: 5,
  created_at: '2023-01-01T00:00:00Z'
};

describe('PostCard', () => {
  let queryClient: QueryClient;
  
  beforeEach(() => {
    queryClient = new QueryClient({
      defaultOptions: { queries: { retry: false } }
    });
  });
  
  it('renders post content correctly', () => {
    render(
      <QueryClientProvider client={queryClient}>
        <PostCard post={mockPost} />
      </QueryClientProvider>
    );
    
    expect(screen.getByText('Test post content')).toBeInTheDocument();
    expect(screen.getByText('testuser')).toBeInTheDocument();
  });
});
```

#### E2E æ¸¬è©¦
```typescript
// e2e/auth.spec.ts
import { test, expect } from '@playwright/test';

test('user can login successfully', async ({ page }) => {
  await page.goto('/auth/login');
  
  await page.fill('input[name="email"]', 'test@example.com');
  await page.fill('input[name="password"]', 'testpass123');
  await page.click('button[type="submit"]');
  
  await expect(page).toHaveURL('/');
  await expect(page.locator('[data-testid="user-menu"]')).toBeVisible();
});
```

### æ¸¬è©¦åŸ·è¡Œ

#### å¾Œç«¯æ¸¬è©¦
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
python manage.py test

# åŸ·è¡Œç‰¹å®šæ‡‰ç”¨æ¸¬è©¦
python manage.py test accounts

# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
coverage run --source='.' manage.py test
coverage report
coverage html
```

#### å‰ç«¯æ¸¬è©¦
```bash
# åŸ·è¡Œå–®å…ƒæ¸¬è©¦
npm test

# åŸ·è¡ŒE2Eæ¸¬è©¦
npm run test:e2e

# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm run test:coverage
```

## âš¡ æ€§èƒ½å„ªåŒ–

### å¾Œç«¯å„ªåŒ–

#### è³‡æ–™åº«å„ªåŒ–
```python
# ä½¿ç”¨ select_related æ¸›å°‘æŸ¥è©¢æ¬¡æ•¸
posts = Post.objects.select_related('author').all()

# ä½¿ç”¨ prefetch_related å„ªåŒ–å¤šå°å¤šæŸ¥è©¢
users = User.objects.prefetch_related('posts', 'followers_set').all()

# ä½¿ç”¨ç´¢å¼•
class Post(models.Model):
    class Meta:
        indexes = [
            models.Index(fields=['author', '-created_at']),
            models.Index(fields=['-created_at']),
        ]
```

#### ç·©å­˜ç­–ç•¥
```python
# Redis ç·©å­˜
from django.core.cache import cache

def get_trending_posts():
    cache_key = 'trending_posts'
    posts = cache.get(cache_key)
    
    if posts is None:
        posts = Post.objects.filter(
            created_at__gte=timezone.now() - timedelta(days=7)
        ).order_by('-likes_count')[:10]
        cache.set(cache_key, posts, timeout=300)  # 5åˆ†é˜
    
    return posts
```

#### ç•°æ­¥ä»»å‹™
```python
# Celery ä»»å‹™
@shared_task
def send_notification_email(user_id, notification_type):
    user = User.objects.get(id=user_id)
    # ç™¼é€éƒµä»¶é‚è¼¯
    send_email(user.email, notification_type)

# åœ¨è¦–åœ–ä¸­ä½¿ç”¨
def create_post(request):
    post = Post.objects.create(...)
    # ç•°æ­¥ç™¼é€é€šçŸ¥
    send_notification_email.delay(post.author.id, 'new_post')
    return Response(...)
```

### å‰ç«¯å„ªåŒ–

#### ä»£ç¢¼åˆ†å‰²
```typescript
// è·¯ç”±ç´šåˆ¥çš„ä»£ç¢¼åˆ†å‰²
const Home = lazy(() => import('../pages/Home'));
const Profile = lazy(() => import('../pages/Profile'));

const App = () => (
  <Suspense fallback={<Loading />}>
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/profile/:username" element={<Profile />} />
    </Routes>
  </Suspense>
);
```

#### åœ–ç‰‡å„ªåŒ–
```typescript
// åœ–ç‰‡æ‡¶åŠ è¼‰
const LazyImage = ({ src, alt, ...props }) => {
  const [isLoaded, setIsLoaded] = useState(false);
  const [isInView, setIsInView] = useState(false);
  const imgRef = useRef();
  
  useEffect(() => {
    const observer = new IntersectionObserver(
      ([entry]) => setIsInView(entry.isIntersecting),
      { threshold: 0.1 }
    );
    
    if (imgRef.current) observer.observe(imgRef.current);
    return () => observer.disconnect();
  }, []);
  
  return (
    <div ref={imgRef} {...props}>
      {isInView && (
        <img
          src={src}
          alt={alt}
          onLoad={() => setIsLoaded(true)}
          className={`transition-opacity ${isLoaded ? 'opacity-100' : 'opacity-0'}`}
        />
      )}
    </div>
  );
};
```

#### React Query å„ªåŒ–
```typescript
// é è¼‰å…¥è³‡æ–™
const usePostsWithPrefetch = (page: number) => {
  const queryClient = useQueryClient();
  
  const query = useQuery({
    queryKey: ['posts', page],
    queryFn: () => postApi.getPosts(page),
  });
  
  // é è¼‰å…¥ä¸‹ä¸€é 
  useEffect(() => {
    if (query.data?.next) {
      queryClient.prefetchQuery({
        queryKey: ['posts', page + 1],
        queryFn: () => postApi.getPosts(page + 1),
      });
    }
  }, [query.data, page, queryClient]);
  
  return query;
};
```

## ğŸ”’ å®‰å…¨è€ƒé‡

### èªè­‰èˆ‡æˆæ¬Š

#### JWT å®‰å…¨é…ç½®
```python
# settings.py
SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=60),
    'REFRESH_TOKEN_LIFETIME': timedelta(days=7),
    'ROTATE_REFRESH_TOKENS': True,
    'BLACKLIST_AFTER_ROTATION': True,
    'ALGORITHM': 'HS256',
    'SIGNING_KEY': SECRET_KEY,
}
```

#### æ¬Šé™æª¢æŸ¥
```python
class PostViewSet(viewsets.ModelViewSet):
    def get_permissions(self):
        if self.action in ['create', 'update', 'partial_update', 'destroy']:
            permission_classes = [IsAuthenticated, IsOwnerOrReadOnly]
        else:
            permission_classes = [AllowAny]
        return [permission() for permission in permission_classes]
```

### è¼¸å…¥é©—è­‰

#### å¾Œç«¯é©—è­‰
```python
class PostSerializer(serializers.ModelSerializer):
    content = serializers.CharField(
        max_length=5000,
        validators=[
            RegexValidator(
                regex=r'^[^<>]*$',
                message='å…§å®¹ä¸èƒ½åŒ…å«HTMLæ¨™ç±¤'
            )
        ]
    )
    
    def validate_code_snippet(self, value):
        if value and len(value.split('\n')) > 100:
            raise serializers.ValidationError('ç¨‹å¼ç¢¼ä¸èƒ½è¶…é100è¡Œ')
        return value
```

#### å‰ç«¯é©—è­‰
```typescript
const postSchema = z.object({
  content: z.string()
    .min(1, 'å…§å®¹ä¸èƒ½ç‚ºç©º')
    .max(5000, 'å…§å®¹ä¸èƒ½è¶…é5000å­—ç¬¦')
    .refine(value => !/<[^>]*>/.test(value), 'å…§å®¹ä¸èƒ½åŒ…å«HTMLæ¨™ç±¤'),
  code_snippet: z.string()
    .optional()
    .refine(value => !value || value.split('\n').length <= 100, 'ç¨‹å¼ç¢¼ä¸èƒ½è¶…é100è¡Œ')
});
```

### æ–‡ä»¶ä¸Šå‚³å®‰å…¨

#### æ–‡ä»¶é¡å‹æª¢æŸ¥
```python
def validate_image_file(file):
    # æª¢æŸ¥æ–‡ä»¶æ“´å±•å
    valid_extensions = ['.jpg', '.jpeg', '.png', '.gif', '.webp']
    ext = os.path.splitext(file.name)[1].lower()
    if ext not in valid_extensions:
        raise ValidationError('ä¸æ”¯æ´çš„åœ–ç‰‡æ ¼å¼')
    
    # æª¢æŸ¥ MIME é¡å‹
    if not file.content_type.startswith('image/'):
        raise ValidationError('æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„åœ–ç‰‡')
    
    # æª¢æŸ¥æ–‡ä»¶å¤§å°
    if file.size > 10 * 1024 * 1024:  # 10MB
        raise ValidationError('åœ–ç‰‡å¤§å°ä¸èƒ½è¶…é10MB')
    
    return file
```

### CORS èˆ‡ CSRF ä¿è­·

#### CORS è¨­ç½®
```python
# settings.py
CORS_ALLOWED_ORIGINS = [
    "https://yourdomain.com",
    "https://www.yourdomain.com",
]

CORS_ALLOW_CREDENTIALS = True

CORS_ALLOW_HEADERS = [
    'accept',
    'authorization',
    'content-type',
    'x-csrftoken',
]
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

#### 1. è³‡æ–™åº«é€£æ¥å•é¡Œ
```bash
# æª¢æŸ¥ PostgreSQL æœå‹™ç‹€æ…‹
sudo systemctl status postgresql

# æª¢æŸ¥é€£æ¥
psql -h localhost -U postgres -d engineerhub

# æª¢æŸ¥ Django è³‡æ–™åº«è¨­ç½®
python manage.py dbshell
```

#### 2. Redis é€£æ¥å•é¡Œ
```bash
# æª¢æŸ¥ Redis æœå‹™
redis-cli ping

# æª¢æŸ¥ Django ç·©å­˜è¨­ç½®
python manage.py shell
>>> from django.core.cache import cache
>>> cache.set('test', 'value')
>>> cache.get('test')
```

#### 3. å‰ç«¯ç·¨è­¯å•é¡Œ
```bash
# æ¸…é™¤ node_modules å’Œé‡æ–°å®‰è£
rm -rf node_modules package-lock.json
npm install

# æª¢æŸ¥ TypeScript éŒ¯èª¤
npm run type-check

# æª¢æŸ¥ ESLint éŒ¯èª¤
npm run lint
```

### æ—¥èªŒåˆ†æ

#### å¾Œç«¯æ—¥èªŒ
```python
# åœ¨ views.py ä¸­æ·»åŠ æ—¥èªŒ
import logging

logger = logging.getLogger('engineerhub.posts')

class PostViewSet(viewsets.ModelViewSet):
    def create(self, request):
        logger.info(f'ç”¨æˆ¶ {request.user.username} å˜—è©¦å‰µå»ºè²¼æ–‡')
        try:
            # å‰µå»ºè²¼æ–‡é‚è¼¯
            logger.info(f'è²¼æ–‡å‰µå»ºæˆåŠŸ: {post.id}')
            return Response(...)
        except Exception as e:
            logger.error(f'è²¼æ–‡å‰µå»ºå¤±æ•—: {str(e)}')
            raise
```

#### å‰ç«¯éŒ¯èª¤è¿½è¹¤
```typescript
// å…¨å±€éŒ¯èª¤è™•ç†
window.addEventListener('error', (event) => {
  console.error('Global Error:', event.error);
  // ç™¼é€åˆ°éŒ¯èª¤è¿½è¹¤æœå‹™
  errorTracker.captureException(event.error);
});

// React Query éŒ¯èª¤è™•ç†
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      onError: (error) => {
        console.error('Query Error:', error);
        toast.error('æ•¸æ“šè¼‰å…¥å¤±æ•—ï¼Œè«‹é‡è©¦');
      },
    },
  },
});
```

### æ€§èƒ½ç›£æ§

#### å¾Œç«¯æ€§èƒ½
```python
# ä½¿ç”¨ Django Debug Toolbar ç›£æ§æŸ¥è©¢
INSTALLED_APPS += ['debug_toolbar']

# ä½¿ç”¨ django-silk åˆ†ææ€§èƒ½
INSTALLED_APPS += ['silk']

# è‡ªå®šç¾©ä¸­é–“ä»¶ç›£æ§éŸ¿æ‡‰æ™‚é–“
class ResponseTimeMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response
    
    def __call__(self, request):
        start_time = time.time()
        response = self.get_response(request)
        duration = time.time() - start_time
        
        response['X-Response-Time'] = str(duration)
        
        if duration > 1.0:  # è¶…é1ç§’è¨˜éŒ„è­¦å‘Š
            logger.warning(f'æ…¢æŸ¥è©¢: {request.path} - {duration:.2f}s')
        
        return response
```

#### å‰ç«¯æ€§èƒ½
```typescript
// ä½¿ç”¨ Web Vitals ç›£æ§
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

function sendToAnalytics(metric) {
  console.log(metric);
  // ç™¼é€åˆ°åˆ†ææœå‹™
}

getCLS(sendToAnalytics);
getFID(sendToAnalytics);
getFCP(sendToAnalytics);
getLCP(sendToAnalytics);
getTTFB(sendToAnalytics);
```

---

## ğŸ“ æ”¯æ´èˆ‡è¯ç¹«

å¦‚æœæ‚¨åœ¨é–‹ç™¼éç¨‹ä¸­é‡åˆ°å•é¡Œï¼Œè«‹åƒè€ƒï¼š

1. **æ–‡æª”**: æŸ¥çœ‹æœ¬å°è¦½å’Œç›¸é—œæŠ€è¡“æ–‡æª”
2. **Issue è¿½è¹¤**: åœ¨ GitHub ä¸Šå‰µå»º Issue
3. **åœ˜éšŠæºé€š**: é€šé Slack/Teams è¯ç¹«é–‹ç™¼åœ˜éšŠ
4. **ä»£ç¢¼å¯©æŸ¥**: æäº¤ Pull Request ç²å¾—åŒäº‹å¹«åŠ©

---

**ç¥æ‚¨é–‹ç™¼æ„‰å¿«ï¼ğŸš€**

*æœ€å¾Œæ›´æ–°ï¼š2024å¹´1æœˆ* 